<div class="turnos-container">
    <mat-card class="turnos-header-card">
        <mat-card-header>
            <mat-icon mat-card-avatar color="primary">event_available</mat-icon>
            <mat-card-title>Turnos Programados</mat-card-title>
            <mat-card-subtitle>Agenda diaria de pacientes confirmados</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content class="date-selector-row">
             <mat-form-field appearance="outline" class="date-picker-field">
                <mat-label>Consultar Fecha</mat-label>
                <input matInput [matDatepicker]="picker" 
                       [(ngModel)]="fechaSeleccionada" 
                       (dateChange)="cargarTurnos()"
                       placeholder="Selecciona una fecha">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
        </mat-card-content>
    </mat-card>
    
    <div class="table-wrapper">
        <table mat-table [dataSource]="turnos" class="mat-elevation-z4 turnos-table" *ngIf="turnos.length > 0">
            <ng-container matColumnDef="hora">
                <th mat-header-cell *matHeaderCellDef><mat-icon>schedule</mat-icon> Hora</th>
                <td mat-cell *matCellDef="let t"> {{t.hora}} </td>
            </ng-container>

            <ng-container matColumnDef="paciente">
                <th mat-header-cell *matHeaderCellDef>Paciente</th>
                <td mat-cell *matCellDef="let t"> <strong>{{t.paciente}}</strong> </td>
            </ng-container>

            <ng-container matColumnDef="edad">
                <th mat-header-cell *matHeaderCellDef>Edad</th>
                <td mat-cell *matCellDef="let t"> {{t.edad}} a√±os </td>
            </ng-container>

            <ng-container matColumnDef="nota">
                <th mat-header-cell *matHeaderCellDef>Nota</th>
                <td mat-cell *matCellDef="let t"> 
                    <span *ngIf="!t.nota || t.nota.length < 20">{{t.nota || 'N/A'}}</span>
                    <mat-icon *ngIf="t.nota && t.nota.length >= 20" matTooltip="{{t.nota}}">info</mat-icon>
                </td>
            </ng-container>

            <ng-container matColumnDef="cobertura">
                <th mat-header-cell *matHeaderCellDef>Cobertura</th>
                <td mat-cell *matCellDef="let t"> <span class="coverage-tag">{{t.cobertura}}</span> </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="turnos-row"></tr>
        </table>
    </div>

    <mat-card *ngIf="turnos.length === 0" class="no-turnos-card">
        <mat-card-content>
            <p>No hay turnos programados para la fecha seleccionada ({{fechaSeleccionada | date:'shortDate'}}).</p>
        </mat-card-content>
    </mat-card>
</div>